#summary Export into hCalendar format
#labels Phase-Implementation
= Export to hCal format =

XSL Stylesheet for transformation calendar to hCalendar format.



<code>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:output method="xml" media-type="text/calendar"/>
<xsl:template match="/calendar">
    <xsl:text disable-output-escaping="yes">
        <![CDATA[<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
           "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">]]>
    </xsl:text>
    <html xmlns="http://www.w3.org/1999/xhtml">

        <head>           
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
            <title>hCalendar export</title>
        </head>
        <body>
    <xsl:for-each select="event">
        <p class="vevent">
            <abbr class="dtstart">
             <xsl:value-of select="substring(translate(dateSince,'-',''),1,8)"/>T<xsl:value-of select="translate(timeFrom,':','')"/>
             <xsl:value-of select="substring(dateSince,11,1)"/>
            </abbr>
            <abbr class="dtend">
             <xsl:value-of select="substring(translate(dateTo,'-',''),1,8)"/>T<xsl:value-of select="translate(timeTo,':','')"/>
             <xsl:value-of select="substring(dateTo,11,1)"/>
            </abbr>
            <span class="summary"><xsl:value-of select="title" /></span>
            <xsl:if test="place != ''">
                <abbr class="location"><xsl:value-of select="place" /></abbr>
            </xsl:if>
            <xsl:if test="note != ''">
                <abbr class="description"><xsl:value-of select="note" /></abbr>
            </xsl:if>
            <xsl:if test="tag">
                <abbr class="category"><xsl:value-of select="tag/@tagref" /></abbr>
            </xsl:if>
        </p>
    </xsl:for-each>
        </body>
    </html>
</xsl:template>
</xsl:stylesheet>
</code>